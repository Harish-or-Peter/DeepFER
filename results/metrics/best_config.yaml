run:
  name: efficientnet_b0_tl_1754965404          # <- use your actual run folder name
  timestamp: 2025-08-12                        # set todayâ€™s date (IST)

model:
  backbone: efficientnet_b0
  num_classes: 7
  classifier_dropout: 0.4
  unfreeze_blocks: ["features.5","features.6","features.7","classifier"]

data:
  image_size: 224
  normalization_mean: [0.485, 0.456, 0.406]
  normalization_std:  [0.229, 0.224, 0.225]
  train_transforms:
    - Resize: 257
    - RandomResizedCrop: 224, scale=(0.6,1.0)
    - RandomHorizontalFlip: 0.5
    - RandomRotation: 15
    - ColorJitter: {brightness: 0.15, contrast: 0.15, saturation: 0.1, hue: 0.02}
    - RandAugment: {num_ops: 2, magnitude: 5}
    - ToTensor
    - Normalize: imagenet
    - RandomErasing: {p: 0.10, scale: [0.02,0.15], ratio: [0.3,3.3]}
  val_test_transforms:
    - Resize: 256
    - CenterCrop: 224
    - ToTensor
    - Normalize: imagenet
  sampler: weighted_random
  class_weights_source: results/metrics/data_audit_per_class.csv
  classes: ["angry","disgust","fear","happy","neutral","sad","surprise"]
  splits:
    train_dir: data/train
    val_dir:   data/val
    test_dir:  data/test
  classes_json: data/metadata/classes.json

training:
  seed: 42
  device: cpu                               # set cuda if you use GPU
  optimizer: AdamW
  scheduler: CosineAnnealingLR
  weight_decay: 1.0e-4
  batch_size: 48
  epochs_head: 5
  epochs_ft: 25
  lr_head: 1.0e-3
  lr_ft: 2.0e-4
  patience: 8
  label_smoothing_ft: 0.1
  use_mixup: true
  mixup_alpha: 0.1
  use_tta: true

metrics:                                      # fill from your saved reports if you like
  val_accuracy: 0.6959
  test_accuracy: 0.7008
  macro_f1_val: null
  macro_f1_test: null

artifacts:
  checkpoint_best: models/final_model/model_best.pt
  manifest:        models/final_model/manifest.txt
  reports_dir:     results/metrics
  confusion_matrix_val: results/metrics/efficientnet_b0_tl_1754965404_val_confusion_matrix.csv
  confusion_matrix_test: results/metrics/efficientnet_b0_tl_1754965404_test_confusion_matrix.csv
  classification_report_val:  results/metrics/efficientnet_b0_tl_1754965404_val_report.txt
  classification_report_test: results/metrics/efficientnet_b0_tl_1754965404_test_report.txt

repro:
  python: "3.12"
  torch:  "<fill: python -c 'import torch;print(torch.__version__)'>"
  torchvision: "<fill: python -c 'import torchvision;print(torchvision.__version__)'>"
  git_commit: "<optional if you init git>"
